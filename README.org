* My NixOS configuration
Abandon hope, all ye who enter here.

[[./screenshot.png]]

** Machines
| akyuro        | Laptop       |
| TODO astylos  | Main PC      |
| TODO bunny    | Main Server  |
| TODO laniakea | Odroid M1    |
| TODO rubicon  | Raspberry Pi |

** Modules
- base
  - nix-settings: Default settings for Nix, the store and nixpkgs
  - system: Basic system settings & services.
    CHANGE HERE: keymap, locale, timezone.
  - user: My user account.
    The password hash is stored in the encrypted file [[file:modules/base/hash.secret]].
    When this file is not decrypted, the default password
    of " " (a single space) will be used.
    To change it:
    - create a new hash: ~mkpasswd > modules/base/hash.secret~
    - change ~wantHash~ in [[file:modules/base/user.nix]] to the hash from \\
      ~sha256sum modules/base/hash.secret~
    - optionally reencrypt with [[https://github.com/AGWA/git-crypt][git-crypt]]:
      #+begin_src shell
        rm -rf .git-crypt .git/git-crypt
        git crypt init
        git crypt add-gpg-user your@gpg.id
      #+end_src
- boot
  - default: systemd-boot as UEFI bootloader & some kernel settings
  - lanza: Use [[https://github.com/nix-community/lanzaboote][Lanzaboote]] for Secure Boot
  - zfs: Enable booting from ZFS
- home
  - gui: Default settings for a graphical system
  - hyprland: My current [[https://hyprland.org/][Hyprland]] setup for user-facing machines
  - terminal: Default settings for a nice terminal environment
- networking
  - bluetooth: Enables bluetooth (duh)
  - default: Enables NetworkManager & WiFi and exposes TCP ports
    18213 and 37812 in the firewall (cuz I like those)
  - tailscale: Enables [[https://tailscale.com/][Tailscale]], a Wireguard mesh VPN
- security
  - u2f: Enables usage of [[https://solokeys.com/][FIDO2 security keys]] for sudo authentication
- virt
  - docker: Enables (rootless) docker
  - libvirt: Enables [[https://libvirt.org/][libvirt]], a virtualisation framework

** In progress
See [[file:machines/test/default.nix]] for this stuff.
- Settings for [[https://github.com/nix-community/impermanence][impermanence]]
- System dataset: automatic unlocking via [[https://github.com/latchset/clevis][clevis]] in initrd
- User datasets: unlock on login via PAM module
